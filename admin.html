<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLP INTERNSHIP V.260127 (V36)</title>
    
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <style>
        /* ... (CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ) ... */
        :root { --bg-body: #f4f6f9; --bg-card: #ffffff; --text-main: #333; --text-sub: #666; --col-bg: #f8f9fa; --border-color: #e0e0e0; --primary: #4361ee; --success: #2ec4b6; --warning: #ff9f1c; --danger: #ef233c; --dark: #2b2d42; }
        body.dark-mode { --bg-body: #1a1a1a; --bg-card: #2d2d2d; --text-main: #e0e0e0; --text-sub: #aaa; --col-bg: #333; --border-color: #444; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-body); color: var(--text-main); margin: 0; transition: 0.3s; }
        #dashboard-container { display: none; max-width: 1400px; margin: 0 auto; padding: 20px; }
        .flex-between { display: flex; justify-content: space-between; align-items: center; }
        #login-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; }
        .login-card { background: var(--bg-card); padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 400px; text-align: center; }
        .input-group input, .input-group select { width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-card); color: var(--text-main); margin-top: 5px; box-sizing: border-box; }
        .magic-btn { background: var(--primary); color: white; border: none; padding: 12px; width: 100%; border-radius: 8px; margin-top: 20px; cursor: pointer; font-weight: bold; }
        .tab-nav { display: flex; border-bottom: 2px solid var(--border-color); margin-bottom: 20px; overflow-x: auto; gap: 10px; }
        .tab-btn { padding: 10px 20px; border: none; background: none; cursor: pointer; font-weight: 600; color: var(--text-sub); border-radius: 8px 8px 0 0; white-space: nowrap; }
        .tab-btn.active { background: var(--bg-card); color: var(--primary); border-bottom: 3px solid var(--primary); }
        .tab-content { display: none; animation: fadeIn 0.3s; } .tab-content.active { display: block; }
        table { width: 100%; border-collapse: collapse; background: var(--bg-card); border-radius: 8px; overflow: hidden; margin-bottom: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border-color); vertical-align: middle; }
        th { background: var(--col-bg); color: var(--text-sub); }
        .btn-sm { padding: 6px 12px; border-radius: 6px; border: none; cursor: pointer; color: white; font-size: 0.85em; font-weight: 500; transition: 0.2s; margin: 0 2px; }
        .btn-primary { background: var(--primary); } .btn-danger { background: var(--danger); } 
        .btn-success { background: var(--success); } .btn-warning { background: var(--warning); color: black; } .btn-dark { background: var(--dark); }
        .badge { padding: 5px 10px; border-radius: 20px; font-size: 0.75em; font-weight: bold; color: white; display: inline-block; }
        .user-pic { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; border: 2px solid #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1); vertical-align: middle; margin-right: 10px; }
        .header-row { display: flex; justify-content: space-between; align-items: center; margin-top: 30px; margin-bottom: 15px; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        .header-row h3 { margin: 0; display: flex; align-items: center; gap: 10px; font-size: 1.2em; color: var(--text-main); }
        .filter-pill { display: flex; align-items: center; gap: 8px; background: var(--bg-card); border: 1px solid var(--border-color); padding: 6px 14px; border-radius: 50px; font-size: 0.85em; font-weight: 600; color: var(--text-sub); cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.03); user-select: none; }
        .filter-pill:hover { border-color: var(--primary); color: var(--primary); transform: translateY(-1px); }
        .filter-pill input { margin: 0; width: 16px; height: 16px; accent-color: var(--primary); cursor: pointer; }
        .filter-pill.active { background: var(--primary); color: white; border-color: var(--primary); }
        .kanban-board { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 20px; align-items: stretch; min-height: 500px; }
        .kanban-col { flex: 1; min-width: 300px; background: var(--col-bg); border-radius: 12px; padding: 15px; display: flex; flex-direction: column; border: 1px solid var(--border-color); }
        .kanban-header { font-weight: bold; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        .kanban-list { flex: 1; min-height: 100px; }
        .kanban-card { background: var(--bg-card); padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 10px; border-left: 5px solid #ccc; cursor: grab; position: relative; }
        .assignee-stack { display: flex; margin-top: 10px; padding-left: 5px; }
        .assignee-img { width: 32px !important; height: 32px !important; border-radius: 50%; object-fit: cover; border: 2px solid var(--bg-card); margin-left: -10px; transition: transform 0.2s; }
        .assignee-img:first-child { margin-left: 0; } .assignee-img:hover { transform: translateY(-3px); z-index: 10; }
        .card-Backlog { border-left-color: #6c757d; } .card-Doing { border-left-color: #4361ee; } .card-Review { border-left-color: #ff9f1c; } .card-Done { border-left-color: #2ec4b6; }
        .card-badges { display: flex; gap: 5px; margin-bottom: 8px; }
        .badge-pill { padding: 2px 8px; border-radius: 10px; font-size: 0.7em; color: white; }
        .p-High { background: #ef233c; } .p-Medium { background: #ff9f1c; } .p-Low { background: #2ec4b6; }
        .card-desc { display: none; font-size: 0.9em; color: var(--text-sub); margin: 10px 0; border-top: 1px solid var(--border-color); padding-top: 5px; }
        .kanban-card.expanded .card-desc { display: block; }
        .expand-btn { position: absolute; top: 10px; right: 10px; background: none; border: none; color: var(--text-sub); cursor: pointer; }
        .answer-box { margin-top: 10px; padding: 8px; background: #eef2ff; border-radius: 6px; font-size: 0.85em; color: #333; border-left: 3px solid #4361ee; word-wrap: break-word; }
        .answer-box strong { color: #4361ee; display: block; margin-bottom: 3px; }
        .search-bar { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-main); margin-bottom: 15px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: var(--bg-card); margin: 5% auto; padding: 25px; border-radius: 12px; width: 95%; max-width: 700px; position: relative; color: var(--text-main); max-height: 90vh; overflow-y: auto; }
        .close-modal { float: right; font-size: 28px; cursor: pointer; }
        .history-list { list-style: none; padding: 0; max-height: 400px; overflow-y: auto; }
        .history-item { padding: 12px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: flex-start; font-size: 0.9em; gap: 10px; }
        .history-item .h-left { flex: 1; }
        .history-item .h-right { font-weight: bold; text-align: right; white-space: nowrap; }
        .history-item .h-time { font-size: 0.8em; color: var(--text-sub); display: block; margin-top: 3px; }
        .history-item.bonus { color: var(--success); font-weight: bold; background: rgba(46,196,182,0.1); border-radius: 5px; border: none; }
        .history-item.manual { border-left: 3px solid #ff9f1c; background: rgba(255,159,28,0.05); }
        #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 8px; padding: 16px; position: fixed; z-index: 999; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 17px; }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} } @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
        @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
        .leaderboard-card { background: var(--bg-card); padding: 10px 15px; margin-bottom: 10px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between; border-left: 5px solid #ddd; }
        .rank-1 { border-color: #ffd700; background: linear-gradient(to right, rgba(255,215,0,0.1), var(--bg-card)); } .rank-2 { border-color: #c0c0c0; } .rank-3 { border-color: #cd7f32; }
        .score-input { width: 80px !important; text-align: center; font-weight: bold; border: 1px solid #ddd; border-radius: 6px; padding: 5px; margin-right: 5px; }
        .btn-delete-icon { width: 30px; height: 30px; border-radius: 50%; border: none; background: #ffebeb; color: #ef233c; font-weight: bold; font-size: 1.1em; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .btn-delete-icon:hover { background: #ef233c; color: white; transform: rotate(90deg); }
        .timer-text { font-size: 0.85em; color: #ef233c; font-weight: 600; margin-bottom: 5px; display: flex; align-items: center; gap: 5px; }
        .btn-archive { width: 100%; margin-top: 5px; background: #e9ecef; color: #333; border: 1px solid #ddd; border-radius: 6px; padding: 5px; cursor: pointer; font-size: 0.85em; transition: 0.2s; }
        .btn-archive:hover { background: #dbe0e6; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-card">
            <h2>üîê Admin Portal</h2>
            <div id="login-form">
                <div class="input-group"><input type="email" id="email-input" value="medlifeplus@gmail.com" placeholder="Email"></div>
                <button class="magic-btn" onclick="sendMagicLink()">‚ú® Login</button>
            </div>
            <div id="status-msg" style="margin-top:10px; color:red;"></div>
        </div>
    </div>

    <div id="dashboard-container">
        <div class="flex-between" style="margin-bottom:20px;">
            <div><h2 style="margin:0;">üë®‚Äçüíª Admin Dashboard</h2><span id="admin-email" style="font-size:0.8em; color:var(--text-sub);"></span></div>
            <div style="display:flex; gap:10px; align-items:center;">
                <button class="btn-sm" style="font-size:1.2em; background:none; border:none;" onclick="toggleTheme()">üåì</button>
                <button class="magic-btn" style="width:auto; margin:0; padding:8px 15px;" onclick="shareLeaderboard()">üì§ Share</button>
                <button class="magic-btn" style="width:auto; margin:0; padding:8px 15px; background:var(--danger);" onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('tab-works')">üìÑ ‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô</button>
            <button class="tab-btn" onclick="switchTab('tab-sidequest')">üó∫Ô∏è Kanban Board</button>
            <button class="tab-btn" onclick="switchTab('tab-manage-quest')">‚öôÔ∏è Daily Quest</button>
            <button class="tab-btn" onclick="switchTab('tab-users')">üë• Users</button>
            <button class="tab-btn" onclick="switchTab('tab-leaderboard')">üèÜ Leaderboard</button>
        </div>

        <div id="tab-works" class="tab-content active">
             <div class="header-row"><h3>üìÅ ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h3><label class="filter-pill"><input type="checkbox" id="hideCompleted" onchange="toggleFilter()" checked> üì• ‡πÄ‡∏Å‡πá‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß</label></div>
             <div style="overflow-x:auto;"><table id="worksTable"><thead><tr><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</th><th>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th><th>‡∏•‡∏¥‡∏á‡∏Å‡πå</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th><th>‡∏•‡∏ö</th></tr></thead><tbody></tbody></table></div>
             <div class="header-row"><h3>‚ö° Daily Answers</h3></div>
             <div style="overflow-x:auto;"><table id="questTable"><thead><tr><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</th><th>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead><tbody></tbody></table></div>
        </div>

        <div id="tab-sidequest" class="tab-content">
            <div style="background:var(--col-bg); padding:20px; border-radius:12px; margin-bottom:20px; border:1px solid var(--border-color);">
                <div class="flex-between" style="cursor:pointer;" onclick="toggleForm()">
                    <h3 id="form-header" style="margin:0; color:var(--primary);">‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà</h3>
                    <div><button class="btn-sm btn-dark" onclick="openArchiveModal()">üóÑÔ∏è ‡∏î‡∏π‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤</button> <span>üîΩ</span></div>
                </div>
                <div id="sq-form" style="display:none; margin-top:15px;">
                    <input type="hidden" id="edit-id" value="">
                    <div class="input-group"><input type="text" id="sq-title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô..."><input type="text" id="sq-desc" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î..."></div>
                    <div style="display:flex; gap:10px; margin-top:10px;">
                        <select id="sq-priority" style="flex:1;"><option value="Low">üü¢ Low</option><option value="Medium" selected>üü° Medium</option><option value="High">üî¥ High</option></select>
                        <input type="date" id="sq-due" style="flex:1;">
                    </div>
                    <p style="margin:10px 0 5px 0;">Assign to:</p><div id="sq-user-list" style="display:flex; flex-wrap:wrap; gap:5px; max-height:100px; overflow-y:auto; border:1px solid #ccc; padding:5px;">Loading...</div>
                    <div style="margin-top:10px; display:flex; gap:10px;">
                        <button id="btn-submit-task" class="magic-btn" onclick="saveSideQuest()">üöÄ Create</button>
                        <button id="btn-cancel-task" class="magic-btn" style="background:#6c757d; display:none;" onclick="resetForm()">‚ùå Cancel</button>
                    </div>
                </div>
            </div>
            <input type="text" class="search-bar" id="board-search" placeholder="üîç Filter tasks..." onkeyup="filterBoard()">
            <div class="kanban-board">
                <div class="kanban-col"><div class="kanban-header">üìå Backlog <span class="badge" style="background:#6c757d" id="cnt-Backlog">0</span></div><div id="Backlog" class="kanban-list"></div></div>
                <div class="kanban-col"><div class="kanban-header">üöß Doing <span class="badge" style="background:#4361ee" id="cnt-Doing">0</span></div><div id="Doing" class="kanban-list"></div></div>
                <div class="kanban-col"><div class="kanban-header">üëÄ Review <span class="badge" style="background:#ff9f1c" id="cnt-Review">0</span></div><div id="Review" class="kanban-list"></div></div>
                <div class="kanban-col"><div class="kanban-header">‚úÖ Done (48h) <span class="badge" style="background:#2ec4b6" id="cnt-Done">0</span></div><div id="Done" class="kanban-list"></div></div>
            </div>
        </div>

        <div id="tab-manage-quest" class="tab-content">
             <div style="background:var(--col-bg); padding:20px; border-radius:12px; margin-bottom:20px;">
                <h3>üì¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á Daily Quest</h3>
                <input type="text" id="q-text" placeholder="‡πÇ‡∏à‡∏ó‡∏¢‡πå..." style="width:100%; padding:10px; margin-bottom:5px;">
                <div style="display:flex; gap:10px;"><input type="text" id="q-img" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ" style="flex:1;"><input type="text" id="q-link" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ô‡∏ö" style="flex:1;"></div>
                <div style="display:flex; gap:10px; margin-top:10px;"><input type="number" id="q-hours" value="24" placeholder="‡∏ä‡∏°." style="width:60px;"><input type="number" id="q-score" value="10" placeholder="‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô" style="width:60px;"><button class="magic-btn" style="margin-top:0;" onclick="createQuest()">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</button></div>
            </div>
            <div id="active-quest-section" style="display:none; background:#d4edda; padding:15px; border-radius:8px; margin-bottom:20px;"><h3 style="color:#155724; margin:0;">üü¢ Active</h3><table id="activeQuestTable"><thead><tr><th>‡πÇ‡∏à‡∏ó‡∏¢‡πå</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th><th>‡∏¢‡∏∏‡∏ï‡∏¥</th></tr></thead><tbody></tbody></table></div>
            <h3>‚ôªÔ∏è ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</h3><table id="questHistoryTable"><thead><tr><th>‡πÇ‡∏à‡∏ó‡∏¢‡πå</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead><tbody></tbody></table>
        </div>

        <div id="tab-users" class="tab-content">
            <input type="text" class="search-bar" id="userSearch" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠..." onkeyup="filterUsers()">
            <table id="usersTable"><thead><tr><th>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</th><th>Level</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th><th>‡∏õ‡∏£‡∏±‡∏ö (‡πÉ‡∏™‡πà Note)</th><th>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</th><th>‡∏•‡∏ö</th></tr></thead><tbody></tbody></table>
        </div>

        <div id="tab-leaderboard" class="tab-content"><div id="leaderboardList" style="max-width:700px; margin:0 auto;"></div></div>
    </div>

    <div id="historyModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2 id="history-title" style="margin:0;"></h2>
                <button class="btn-sm btn-primary" onclick="copyHistory()">üìã Copy Data</button>
            </div>
            <div id="history-summary" style="margin-bottom:15px;font-weight:bold;color:var(--primary);margin-top:10px;"></div>
            <ul id="history-list" class="history-list"></ul>
        </div>
    </div>
    
    <div id="archiveModal" class="modal"><div class="modal-content"><span class="close-modal" onclick="document.getElementById('archiveModal').style.display='none'">&times;</span><h2 style="margin-top:0;">üóÑÔ∏è ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏∏</h2><div id="archive-list" class="history-list"></div></div></div>
    
    <div id="toast">Saved!</div>

    <script src="firebase-config.js"></script>
    <script>
        const ALLOWED_EMAIL = "medlifeplus@gmail.com";
        const ADMIN_LIFF_ID = "2008959998-yjcNpaGt"; 
        const MY_URL = 'https://mlpditto.github.io/INTERN-PORT/admin.html';
        const auth = firebase.auth();
        let topUsersCache = [];
        let allSideQuestsCache = {};
        let submissionMap = {};
        let currentHistoryText = "";

        // Auth
        function toggleTheme() { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light'); }
        if(localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode');
        if (auth.isSignInWithEmailLink(window.location.href)) { let email = localStorage.getItem('emailForSignIn') || prompt('Email:'); auth.signInWithEmailLink(email, window.location.href).then(() => { localStorage.removeItem('emailForSignIn'); location.replace(MY_URL); }); }
        function sendMagicLink() { const email = document.getElementById('email-input').value; if(email!==ALLOWED_EMAIL) return alert("No Permission"); auth.sendSignInLinkToEmail(email, { url:MY_URL, handleCodeInApp:true }).then(() => { localStorage.setItem('emailForSignIn',email); alert("Check Email"); }); }
        auth.onAuthStateChanged(user => { if(user && user.email===ALLOWED_EMAIL) { document.getElementById('login-screen').style.display='none'; document.getElementById('dashboard-container').style.display='block'; document.getElementById('admin-email').innerText=user.email; initSystem(); } });
        function logout() { auth.signOut().then(() => location.reload()); }

        let isInit = false;
        async function initSystem() {
            if(isInit) return; isInit = true;
            try { await liff.init({ liffId: ADMIN_LIFF_ID }); } catch(e) {}
            loadWorks(); loadQuestSubmissions(); loadActiveQuests(); loadQuestHistory(); loadUsers(); loadSideQuests();
            initSortable();
            setInterval(updateDoneTimers, 60000); 
        }
        function switchTab(id) { document.querySelectorAll('.tab-content').forEach(e=>e.classList.remove('active')); document.querySelectorAll('.tab-btn').forEach(e=>e.classList.remove('active')); document.getElementById(id).classList.add('active'); event.target.classList.add('active'); }

        // --- Works ---
        function toggleFilter() { const chk = document.getElementById('hideCompleted'); chk.parentElement.classList.toggle('active', chk.checked); loadWorks(); loadQuestSubmissions(); }
        function loadWorks() {
            const h=document.getElementById('hideCompleted').checked;
            db.collection("works").orderBy("timestamp","desc").limit(100).onSnapshot(s=>{
                const t=document.querySelector("#worksTable tbody"); t.innerHTML="";
                s.forEach(d=>{ 
                    const w=d.data(); if(h&&w.status==="‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß")return;
                    const st=w.status==='‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß'?'#2ec4b6':w.status==='‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç'?'#ef233c':'#ff9f1c';
                    t.innerHTML+=`<tr><td>${w.timestamp?.toDate().toLocaleString('th-TH')||''}</td><td><div style="display:flex;align-items:center;"><img src="${w.pictureUrl||''}" class="user-pic">${w.displayName}</div></td><td>${w.title}</td><td><a href="${w.link}" target="_blank" class="btn-sm btn-dark">Link</a></td><td><span class="badge" style="background:${st}">${w.status}</span></td><td><div style="display:flex;align-items:center;"><input type="number" step="0.1" id="sc-${d.id}" value="${w.score||0}" class="score-input"><button class="btn-sm btn-primary" onclick="svSc('${d.id}','${w.userId}',${w.score||0})">üíæ</button></div></td><td><button class="btn-delete-icon" onclick="delWork('${d.id}')">‚úï</button></td></tr>`
                }) 
            }) 
        }
        function loadQuestSubmissions() {
            const h=document.getElementById('hideCompleted').checked;
            db.collection("quest_submissions").orderBy("timestamp","desc").limit(100).onSnapshot(s=>{ 
                const t=document.querySelector("#questTable tbody"); t.innerHTML=""; 
                s.forEach(d=>{ 
                    const q=d.data(); submissionMap[`${q.questId}_${q.userId}`] = q.answer;
                    const c=q.status==='checked'; if(h&&c)return; 
                    let ans=q.answer; if(ans.startsWith('http')) ans=`<a href="${ans}" target="_blank" class="btn-sm btn-dark">üîó Link</a>`;
                    const tot=(q.earnedScore||0)+(q.bonusGiven||0);
                    t.innerHTML+=`<tr><td>${q.timestamp?.toDate().toLocaleString('th-TH')||''}</td><td><div style="display:flex;align-items:center;"><img src="${q.pictureUrl||''}" class="user-pic">${q.displayName}</div></td><td>${ans}</td><td><span class="badge" style="background:${q.isLate?'#ef233c':'#2ec4b6'}">${q.isLate?'‡∏ä‡πâ‡∏≤':'‡∏ó‡∏±‡∏ô'}</span></td><td><div style="display:flex;align-items:center;"><input type="number" step="0.1" id="qsc-${d.id}" value="${tot}" class="score-input"><button class="btn-sm btn-warning" onclick="upQSc('${d.id}','${q.userId}',${tot},${q.earnedScore||0})">‡πÅ‡∏Å‡πâ</button></div></td><td><button class="btn-sm btn-success" onclick="checkQuest('${d.id}')">‚úî</button> <button class="btn-delete-icon" onclick="delQSub('${d.id}','${q.userId}',${tot})">‚úï</button></td></tr>`
                }) 
            }) 
        }
        async function checkQuest(id) { await db.collection("quest_submissions").doc(id).update({ status: 'checked' }); showToast("Checked!"); }

        // --- Side Quest ---
        function loadSideQuests() { db.collection("side_quests").orderBy("createdAt", "desc").onSnapshot(s => { const c = { "Backlog": document.getElementById("Backlog"), "Doing": document.getElementById("Doing"), "Review": document.getElementById("Review"), "Done": document.getElementById("Done") }; Object.values(c).forEach(el => el.innerHTML = ""); const cnt = { "Backlog": 0, "Doing": 0, "Review": 0, "Done": 0 }; s.forEach(d => { const q = d.data(); allSideQuestsCache[d.id] = q; if(q.status==='Archived') return; if(c[q.status]) { cnt[q.status]++; c[q.status].appendChild(createCard(d.id, q)); } }); Object.keys(cnt).forEach(k => document.getElementById(`cnt-${k}`).innerText = cnt[k]); updateDoneTimers(); }); }
        
        function createCard(id, q) { 
            const d=document.createElement('div'); d.className=`kanban-card card-${q.status}`; d.setAttribute('data-id',id); d.onclick=(e)=>{if(!e.target.closest('button'))d.classList.toggle('expanded')}; 
            let extraHtml = ""; if (q.status === 'Done' && q.doneAt) { extraHtml = `<div class="timer-text" data-done="${q.doneAt.toMillis()}">‚è≥ Loading...</div><button class="btn-archive" onclick="archiveSideQuest('${id}')">üì• ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏∏</button>`; }
            let ansText = q.userAnswer; if (!ansText && q.refQuestId && q.assigneeIds && q.assigneeIds.length > 0) { const key = `${q.refQuestId}_${q.assigneeIds[0]}`; if (submissionMap[key]) ansText = submissionMap[key]; }
            let ansHtml = ""; if (ansText) { let a = ansText; if(a.startsWith("http")) a=`<a href="${a}" target="_blank">üîó Link</a>`; ansHtml=`<div class="answer-box"><strong>üí¨ ‡∏ï‡∏≠‡∏ö:</strong> ${a}</div>`; }
            let as='<div class="assignee-stack">'; if(q.assignees) q.assignees.forEach(u => as+=`<img src="${u.pic}" class="assignee-img" title="${u.name}">`); as+='</div>'; 
            d.innerHTML=`<div class="card-badges"><span class="badge-pill p-${q.priority}">${q.priority||'Normal'}</span></div>${extraHtml}<b>${q.title||'No Title'}</b><button class="expand-btn">‚åÑ</button><div class="card-desc"><p>${q.description||'-'}</p><div style="display:flex;justify-content:space-between;margin-top:5px;"><button class="btn-sm btn-warning" onclick="editSideQuest('${id}')">‚úèÔ∏è Edit</button><button class="btn-delete-icon" style="width:25px;height:25px;font-size:0.9em;" onclick="delSQ('${id}')">‚úï</button></div>${q.proofLink?`<a href="${q.proofLink}" target="_blank" class="btn-sm btn-dark" style="display:block;text-align:center;margin-top:5px;">üìé ‡∏î‡∏π‡∏á‡∏≤‡∏ô</a>`:''}</div>${ansHtml} ${as}`; 
            return d; 
        }

        async function openArchiveModal() {
            const m = document.getElementById("archiveModal"); const l = document.getElementById("archive-list");
            l.innerHTML = "<p style='text-align:center'>‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>"; m.style.display = "block";
            try {
                const s = await db.collection("side_quests").where("status", "==", "Archived").get();
                let items = []; s.forEach(doc => items.push({ id: doc.id, ...doc.data() }));
                items.sort((a, b) => (b.createdAt?.toMillis() || 0) - (a.createdAt?.toMillis() || 0));
                l.innerHTML = "";
                if (items.length === 0) { l.innerHTML = "<p style='text-align:center;color:#999'>üì≠ ‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</p>"; return; }
                items.forEach(q => {
                    l.innerHTML += `<div class="history-item"><div class="h-left"><b>${q.title}</b><br><small style="color:#666">${q.description||"-"}</small></div><div class="h-right"><button class="btn-sm btn-success" onclick="restoreSideQuest('${q.id}')">‚Ü∫ ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô</button></div></div>`;
                });
            } catch (e) { l.innerHTML = `<p style='color:red'>Error: ${e.message}</p>`; }
        }

        async function restoreSideQuest(id) {
            const to = prompt("‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? (Backlog, Doing, Review, Done)", "Done");
            if(['Backlog','Doing','Review','Done'].includes(to)) {
                await db.collection("side_quests").doc(id).update({ status: to, doneAt: to==='Done'?firebase.firestore.FieldValue.serverTimestamp():null });
                openArchiveModal(); showToast("Restored!");
            } else alert("‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á‡∏ú‡∏¥‡∏î!");
        }

        function updateDoneTimers() { document.querySelectorAll('.timer-text').forEach(el => { const doneTime = parseInt(el.getAttribute('data-done')); if (!doneTime) return; const now = Date.now(); const diffMs = (doneTime + 48 * 3600000) - now; if (diffMs <= 0) { el.innerText = "‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö...)"; db.collection("side_quests").doc(el.closest('.kanban-card').getAttribute('data-id')).update({status:'Archived'}); } else { const hrs = Math.floor(diffMs / 3600000); const mins = Math.floor((diffMs % 3600000) / 60000); el.innerText = `‚è≥ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${hrs} ‡∏ä‡∏°. ${mins} ‡∏ô‡∏≤‡∏ó‡∏µ`; } }); }
        async function archiveSideQuest(id) { if(confirm("‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏∏?")) await db.collection("side_quests").doc(id).update({status: 'Archived'}); }
        
        // --- Users & History (with Copy) ---
        function loadUsers(){ db.collection("users").orderBy("score","desc").onSnapshot(s=>{ const tb=document.querySelector("#usersTable tbody"); const lb=document.getElementById("leaderboardList"); const sel=document.getElementById("sq-user-list"); tb.innerHTML=""; lb.innerHTML=""; sel.innerHTML=""; topUsersCache=[]; let r=1; s.forEach(d=>{ const u=d.data(); const score=parseFloat((u.score||0).toFixed(2)); const lv=Math.floor(score/10)+1; tb.innerHTML+=`<tr><td><div style="display:flex;align-items:center;"><img src="${u.pictureUrl}" class="user-pic">${u.displayName}</div></td><td><span class="badge" style="background:#eee;color:#555">Lv.${lv}</span></td><td style="font-weight:bold;color:var(--primary);font-size:1.1em;">${score}</td><td><div style="display:flex;align-items:center;"><input type="number" step="0.1" id="adj-${d.id}" placeholder="0.0" class="score-input"><button class="btn-sm btn-success" onclick="adjDec('${d.id}')">üíæ</button></div></td><td><button class="btn-sm btn-dark" onclick="showHistory('${d.id}','${u.displayName}',${score})">üìú</button></td><td><button class="btn-delete-icon" onclick="delUser('${d.id}')">‚úï</button></td></tr>`; sel.innerHTML+=`<label style="margin-right:10px;"><input type="checkbox" class="sq-user-check" value="${d.id}" data-name="${u.displayName}" data-pic="${u.pictureUrl}"> ${u.displayName}</label>`; if(r<=20){ topUsersCache.push(`${r}. ${u.displayName} (${score})`); let cls='rank-other',ic='‚≠ê'; if(r===1){cls='rank-1';ic='üåü';}else if(r===2){cls='rank-2';ic='ü•à';}else if(r===3){cls='rank-3';ic='ü•â';} lb.innerHTML+=`<div class="leaderboard-card ${cls}"><div style="display:flex;align-items:center;"><b style="width:30px">#${r}</b><img src="${u.pictureUrl}" class="user-pic"><span>${u.displayName}</span><span class="badge" style="margin-left:8px;background:#f0f0f0;color:#333;font-size:0.75em;border:1px solid #ddd;">Lv.${lv}</span></div><div><b>${score}</b> ${ic}</div></div>`; } r++; }); }) }
        
        async function adjDec(id){
            const v=parseFloat(document.getElementById(`adj-${id}`).value);
            if(isNaN(v)||v===0)return;
            const note = prompt("üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (Note):", "‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô");
            if(note===null)return;
            try {
                const batch = db.batch();
                batch.update(db.collection("users").doc(id), { score: firebase.firestore.FieldValue.increment(v) });
                batch.set(db.collection("checkin_logs").doc(), { userId: id, type: 'manual_adjust', amount: v, note: note, timestamp: firebase.firestore.FieldValue.serverTimestamp() });
                await batch.commit(); document.getElementById(`adj-${id}`).value=""; showToast("Saved!");
            } catch(e) { alert(e.message); }
        }

        async function showHistory(uid,name,total){
            const m=document.getElementById("historyModal");const l=document.getElementById("history-list");
            document.getElementById("history-title").innerText=`üìú ${name}`;l.innerHTML="<p style='text-align:center'>Loading...</p>";m.style.display="block";
            try {
                let all=[];
                (await db.collection("works").where("userId","==",uid).get()).forEach(d=>{const w=d.data(); if(w.score>0) all.push({t:w.timestamp?.toDate(), type:'work', text:`üìÅ ${w.title}`, score:w.score})});
                (await db.collection("quest_submissions").where("userId","==",uid).get()).forEach(d=>{const q=d.data(); const s=(q.earnedScore||0)+(q.bonusGiven||0); if(q.status!=='none') all.push({t:q.receivedAt?.toDate(), type:'bonus', text:`üöÄ ‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à`, score:0.1}); if(s>0) all.push({t:q.submittedAt?.toDate(), type:'quest', text:`‚ö° Daily: ${q.answer}`, score:s})});
                (await db.collection("checkin_logs").where("userId","==",uid).get()).forEach(d=>{
                    const g=d.data();
                    if(g.type==='streak') all.push({t:g.timestamp?.toDate(), type:'bonus', text:`üî• Streak (${g.count})`, score:g.amount});
                    if(g.type==='manual_adjust') all.push({t:g.timestamp?.toDate(), type:'manual', text:`üõ†Ô∏è ${g.note}`, score:g.amount});
                });
                
                all.sort((a,b)=>(b.t||0)-(a.t||0));
                let html=""; currentHistoryText = "Date\tItem\tScore\n";
                
                all.forEach(e=>{
                    const dStr = e.t ? e.t.toLocaleString('th-TH') : '-';
                    let cls=""; if(e.type==='bonus')cls="bonus"; if(e.type==='manual')cls="manual";
                    html+=`<div class="history-item ${cls}"><div class="h-left"><span>${e.text}</span><br><small class="h-time">${dStr}</small></div><div class="h-right">${e.score>0?'+':''}${e.score}</div></div>`;
                    currentHistoryText += `${dStr}\t${e.text}\t${e.score}\n`;
                });
                document.getElementById("history-summary").innerHTML = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${total.toFixed(2)}`;
                l.innerHTML = html;
            } catch(e) { l.innerHTML = "Error: "+e.message; }
        }

        function copyHistory() { navigator.clipboard.writeText(currentHistoryText).then(() => showToast("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!")); }
        
        function closeModal(){document.getElementById("historyModal").style.display="none"}
        async function svSc(wid,uid,old){const n=parseFloat(document.getElementById('sc-'+wid).value)||0;if(n==old)return;db.collection("works").doc(wid).update({score:n,status:"‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß"});db.collection("users").doc(uid).update({score:firebase.firestore.FieldValue.increment(n-old)});showToast("Saved")}
        async function upQSc(id,uid,cur,base){const n=parseFloat(document.getElementById('qsc-'+id).value)||0;const b=parseFloat((n-base).toFixed(2));if(confirm("Update?")){db.collection("quest_submissions").doc(id).update({bonusGiven:b,status:'checked'});db.collection("users").doc(uid).update({score:firebase.firestore.FieldValue.increment(n-cur)});showToast("Updated")}}
        async function delWork(id){if(confirm("Del?"))db.collection("works").doc(id).delete()}
        async function delQSub(id,uid,sc){if(confirm("Del?")){db.collection("quest_submissions").doc(id).delete();db.collection("users").doc(uid).update({score:firebase.firestore.FieldValue.increment(-sc)})}}
        async function delUser(id){if(confirm("Del User?"))db.collection("users").doc(id).delete()}
        function filterUsers(){const t=document.getElementById('userSearch').value.toLowerCase();document.querySelectorAll('.u-row').forEach(r=>r.style.display=r.innerText.toLowerCase().includes(t)?'':'none')}
        async function shareLeaderboard(){if(!topUsersCache.length)return alert("No Data");const t="üèÜ Top Scores:\n"+topUsersCache.slice(0,10).join("\n");if(liff.isInClient())liff.shareTargetPicker([{type:"text",text:t}]);else navigator.clipboard.writeText(t).then(()=>alert("Copied"))}
        function showToast(m){const x=document.getElementById("toast");x.innerText=m;x.className="show";setTimeout(()=>{x.className=x.className.replace("show","")},3000)}
        async function createQuest(){const q={question:document.getElementById('q-text').value,imageUrl:document.getElementById('q-img').value,questLink:document.getElementById('q-link').value,baseScore:parseFloat(document.getElementById('q-score').value),deadline:new Date(Date.now()+parseFloat(document.getElementById('q-hours').value)*36e5),createdAt:firebase.firestore.FieldValue.serverTimestamp()};if(q.question&&confirm("Post?"))await db.collection("quests").add(q)}
        function loadActiveQuests(){db.collection("quests").orderBy("createdAt","desc").onSnapshot(s=>{const t=document.querySelector("#activeQuestTable tbody");t.innerHTML="";let h=false;s.forEach(d=>{const q=d.data();if(q.deadline?.toDate()>new Date()){h=true;const sq=q.question.replace(/'/g,"\\'").replace(/"/g,"&quot;");const si=(q.imageUrl||"").replace(/'/g,"\\'"),sl=(q.questLink||"").replace(/'/g,"\\'");t.innerHTML+=`<tr><td>${q.question}</td><td>${Math.ceil((q.deadline.toDate()-new Date())/36e5)}h</td><td><button class="btn-sm btn-warning" onclick="editQ('${d.id}','${sq}','${si}','${sl}')">‚úèÔ∏è</button></td><td><button class="btn-delete-icon" onclick="stopQ('${d.id}')">‚úï</button></td></tr>`}});document.getElementById("active-quest-section").style.display=h?"block":"none"})}
        async function stopQ(id){if(confirm("Stop?"))await db.collection("quests").doc(id).update({deadline:new Date(Date.now()-1000)})}
        async function editQ(id,q,i,l){const nq=prompt("Q",q);if(!nq)return;const ni=prompt("Img",i),nl=prompt("Lnk",l);await db.collection("quests").doc(id).update({question:nq,imageUrl:ni,questLink:nl})}
        function loadQuestHistory(){db.collection("quests").orderBy("createdAt","desc").limit(20).onSnapshot(s=>{const t=document.querySelector("#questHistoryTable tbody");t.innerHTML="";s.forEach(d=>{const q=d.data();const sq=q.question.replace(/'/g,"\\'").replace(/"/g,"&quot;");const si=(q.imageUrl||"").replace(/'/g,"\\'"),sl=(q.questLink||"").replace(/'/g,"\\'");t.innerHTML+=`<tr><td>${q.question}</td><td>${q.baseScore}</td><td><button class="btn-sm btn-success" onclick="reuse('${sq}',${q.baseScore},'${si}','${sl}')">‚ôªÔ∏è</button> <button class="btn-delete-icon" onclick="delQ('${d.id}')">‚úï</button></td></tr>`})})}
        function reuse(q,s,i,l){document.getElementById('q-text').value=q;document.getElementById('q-score').value=s;document.getElementById('q-img').value=i;document.getElementById('q-link').value=l;document.querySelector('.tab-content.active').scrollIntoView({behavior:'smooth'})}
        async function delQ(id){if(confirm("Del?"))await db.collection("quests").doc(id).delete()}
        function editSideQuest(id) { const data = allSideQuestsCache[id]; if (!data) return; document.getElementById("edit-id").value = id; document.getElementById("sq-title").value = data.title; document.getElementById("sq-desc").value = data.description; document.getElementById("sq-priority").value = data.priority; document.getElementById("sq-due").value = data.dueDate || ""; document.querySelectorAll('.sq-user-check').forEach(c => { c.checked = (data.assigneeIds || []).includes(c.value); }); document.getElementById("form-header").innerText = "‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à"; document.getElementById("btn-submit-task").innerText = "üíæ Save Change"; document.getElementById("btn-cancel-task").style.display = "inline-block"; const f = document.getElementById("sq-form"); if(f.style.display === "none") f.style.display = "block"; f.scrollIntoView({behavior:"smooth"}); }
        async function saveSideQuest() { const id = document.getElementById("edit-id").value; const t=document.getElementById("sq-title").value, d=document.getElementById("sq-desc").value, p=document.getElementById("sq-priority").value, date=document.getElementById("sq-due").value; const chk=document.querySelectorAll('.sq-user-check:checked'); let u=[]; chk.forEach(c=>u.push({uid:c.value,name:c.dataset.name,pic:c.dataset.pic})); if(!t)return alert("Title?"); const data = {title:t,description:d,priority:p,dueDate:date,assignees:u,assigneeIds:u.map(x=>x.uid)}; if (id) { await db.collection("side_quests").doc(id).update(data); showToast("Updated!"); } else { data.status="Backlog"; data.createdAt=firebase.firestore.FieldValue.serverTimestamp(); await db.collection("side_quests").add(data); showToast("Created!"); } resetForm(); }
        function resetForm() { document.getElementById("edit-id").value = ""; document.getElementById("sq-title").value = ""; document.getElementById("sq-desc").value = ""; document.getElementById("sq-due").value = ""; document.querySelectorAll('.sq-user-check').forEach(c => c.checked = false); document.getElementById("form-header").innerText = "‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà"; document.getElementById("btn-submit-task").innerText = "üöÄ Create"; document.getElementById("btn-cancel-task").style.display = "none"; document.getElementById("sq-form").style.display = "none"; }
        function initSortable() { ['Backlog','Doing','Review','Done'].forEach(id=>{ new Sortable(document.getElementById(id),{group:'shared',animation:150,onEnd:e=>{const ns=e.to.id; const up={status:ns}; if(ns==='Done')up.doneAt=firebase.firestore.FieldValue.serverTimestamp(); db.collection("side_quests").doc(e.item.getAttribute('data-id')).update(up)}}) }) }
        function toggleForm(){const f=document.getElementById("sq-form");f.style.display=f.style.display==="none"?"block":"none"}
        function filterBoard(){const t=document.getElementById("board-search").value.toLowerCase();document.querySelectorAll('.kanban-card').forEach(c=>{c.style.display=c.innerText.toLowerCase().includes(t)?'block':'none'})}
        async function delSQ(id){if(confirm("Del?"))await db.collection("side_quests").doc(id).delete()}
    </script>
</body>
</html>
